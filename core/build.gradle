apply plugin: "java"
sourceCompatibility = 1.6
[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'
sourceSets.main.java.srcDirs = ["src/"]
eclipse.project {
    name = appName + "-core"
}
dependencies {
}

task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'
    from sourceSets.main.allSource
}

publishing {
    publications {
        jar(MavenPublication) {
            artifact 'build/libs/core.jar'
            artifact sourcesJar
            groupId 'ethanjones.modularworld'
            artifactId 'core'
            version buildProperties.version

            pom.withXml {
                def repositories = asNode().appendNode('repositories')
                def libgdxSnapshots = repositories.appendNode('repository')
                libgdxSnapshots.appendNode('id', 'libgdxSnapshots')
                libgdxSnapshots.appendNode('url', 'https://oss.sonatype.org/content/repositories/snapshots/')
                def libgdxReleases = repositories.appendNode('repository')
                libgdxReleases.appendNode('id', 'libgdxReleases')
                libgdxReleases.appendNode('url', 'https://oss.sonatype.org/content/repositories/releases/')

                def dependency = asNode().appendNode('dependencies').appendNode('dependency')
                dependency.appendNode('groupId', 'com.badlogicgames.gdx')
                dependency.appendNode('artifactId', 'gdx')
                dependency.appendNode('version', gdxVersion)
                dependency.appendNode('type', 'jar')
            }
        }
    }
    repositories {
        maven {
            url "../repo"
        }
    }
}

publish.dependsOn(['jar'])